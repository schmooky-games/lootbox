---
title: Взвешенные лутбоксы
description: Подробное описание эндпоинтов API для работы с взвешенными лутбоксами
---

# Действия с взвешенными лутбоксами

## Эндпоинты

### Создание взвешенного лутбокса

**Endpoint:** `POST /weighted/create_lootbox`

Создает новый взвешенный лутбокс с заданными предметами и их весами.

**Параметры запроса:**
- `items` (список словарей): Список предметов для лутбокса. Каждый предмет должен содержать:
  - `data` (объект, опционально): Дополнительные данные предмета.
  - `meta` (объект, опционально):
    - `name` (строка): Название предмета.
  - `weight` (число): Вес предмета (вероятность выпадения).
- `name` (строка): Название лутбокса.
- `draws_count` (целое число, опционально): Количество возможных розыгрышей.

**Пример запроса:**
```json
{
  "items": [
    {
      "data": {},
      "meta": {
        "name": "Rare Sword"
      },
      "weight": 0.3
    },
    {
      "data": {},
      "meta": {
        "name": "Common Shield"
      },
      "weight": 0.7
    }
  ],
  "name": "Warrior's Weighted Lootbox",
  "draws_count": 5
}
```

**Ответ:**
Возвращает созданный объект `WeightedLootbox`.

### Обновление содержимого взвешенного лутбокса

**Endpoint:** `PATCH /weighted/update_lootbox/{lootbox_id}`

Обновляет содержимое существующего взвешенного лутбокса.

**Параметры пути:**
- `lootbox_id` (строка): Идентификатор лутбокса для обновления.

**Параметры запроса:**
- `items` (список объектов `WeightedItem`): Новый список предметов для лутбокса.

**Пример запроса:**
```json
{
  "items": [
    {
      "data": {},
      "meta": {
        "name": "Epic Sword"
      },
      "weight": 0.2
    },
    {
      "data": {},
      "meta": {
        "name": "Legendary Shield"
      },
      "weight": 0.8
    }
  ]
}
```

**Ответ:**
Возвращает обновленный объект `WeightedLootbox`.

### Получение предмета из взвешенного лутбокса

**Endpoint:** `GET /weighted/get_loot/{lootbox_id}`

Выбирает и возвращает предмет из указанного взвешенного лутбокса с учетом весов предметов.

**Параметры пути:**
- `lootbox_id` (строка): Идентификатор лутбокса, из которого нужно получить предмет.

**Ответ:**
Возвращает выбранный объект `WeightedItem`.

**Пример ответа:**
```json
{
  "id": "gpgfr7u7kx",
  "data": {
    "value": ""
  },
  "meta": {
    "name": "Квантовый лазер"
  },
  "weight": 50
}
```

## Модели данных

### WeightedLootbox
- `id` (строка): Уникальный идентификатор лутбокса.
- `meta` (объект `Meta`): Метаданные лутбокса.
- `items` (список объектов `WeightedItem`): Список предметов в лутбоксе.
- `draws_count` (целое число, опционально): Количество возможных розыгрышей.
- `is_active` (логическое значение): Активен ли лутбокс.

### WeightedItem
- `id` (строка): Уникальный идентификатор предмета.
- `data` (объект): Дополнительные данные предмета.
- `meta` (объект `Meta`): Метаданные предмета.
- `weight` (число): Вес предмета (вероятность выпадения).

### Meta
- `name` (строка): Название предмета или лутбокса.

## Обработка ошибок

API может возвращать следующие ошибки:

- `400 Bad Request`:
  - `1001`: Лутбокс не найден.
  - `1003`: В лутбоксе нет предметов.
  - `1004`: Лутбокс не активен.
  - `1005`: Неверный тип лутбокса.

При возникновении ошибки API возвращает соответствующий статус-код и детальное описание проблемы.